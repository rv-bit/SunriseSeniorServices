import{r as n,j as e,c as X,A as de,u as me,b as xe,P as he,R as v,G as V,h as ue}from"./index-BkQICH-X.js";import{B as w}from"./button-DZFmWa-B.js";import"./input-DfNpMjP5.js";import{_ as fe}from"./extends-CCbyfPlC.js";import{$ as pe}from"./index-CTZesL8v.js";import{B as we,c as be}from"./index-DVM--Iqe.js";import{S as je,a as ge}from"./scroll-area-CY_KUaGE.js";import{u as Ne}from"./UseDocumentTitle-McNeP1rR.js";import{N as ve}from"./Notifications-KuRf63x_.js";import"./index-BDpOC3Tw.js";import"./iconBase-r11lJbk7.js";import"./index-Nm5ibAgm.js";const J="horizontal",ye=["horizontal","vertical"],K=n.forwardRef((c,o)=>{const{decorative:f,orientation:u=J,...d}=c,r=Y(u)?u:J,y=f?{role:"none"}:{"aria-orientation":r==="vertical"?r:void 0,role:"separator"};return n.createElement(pe.div,fe({"data-orientation":r},y,d,{ref:o}))});K.propTypes={orientation(c,o,f){const u=c[o],d=String(u);return u&&!Y(u)?new Error(ke(d,f)):null}};function ke(c,o){return`Invalid prop \`orientation\` of value \`${c}\` supplied to \`${o}\`, expected one of:
  - horizontal
  - vertical

Defaulting to \`${J}\`.`}function Y(c){return ye.includes(c)}const Q=K,Z=n.forwardRef(({className:c,orientation:o="horizontal",decorative:f=!0,...u},d)=>e.jsx(Q,{ref:d,decorative:f,orientation:o,className:X("shrink-0 bg-border",o==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",c),...u}));Z.displayName=Q.displayName;function x({className:c,...o}){return e.jsx("div",{className:X("animate-pulse rounded-md bg-zinc-200",c),...o})}const C=[{name:"jobTitle",placeholder:"Job Title",icon:e.jsx(we,{className:"mx-3 size-5"}),styleProps:`
        flex items-center text-slate-600 w-full h-full focus-within:outline-none focus-within:border focus-within:border-[#ed6c39de]
        focus-within:rounded-br-sm focus-within:rounded-tr-sm focus-within:rounded-bl-lg focus-within:rounded-tl-lg focus-within:border-b-4 hover:cursor-text
    `},{name:"location",placeholder:"Location",icon:e.jsx(be,{className:"mx-3 size-5"}),styleProps:`
        flex items-center text-slate-600 w-full h-full focus-within:outline-none focus-within:border focus-within:border-r-2 focus-within:border-[#ed6c39de] 
        focus-within:rounded-br-lg focus-within:rounded-tr-lg focus-within:rounded-bl-sm focus-within:rounded-tl-sm focus-within:border-b-4 hover:cursor-text
    `}],Ae=()=>{var z,B,H,U,W,q,G;Ne("Job Listings");const{userAuthData:c}=n.useContext(de),o=me(),f=xe(),d=new URLSearchParams(f.search).get("currentJobId"),[r,E]=n.useState([]),[y,L]=n.useState(!1),[b,T]=n.useState({jobTitle:"",location:""});n.useState([]);const[i,j]=n.useState(null),[g,F]=n.useState(null),[ee,_]=n.useState(!1),[p,N]=n.useState({open:!1,message:""}),D=(t,s)=>{T({...b,[s]:t.target.value})},P=t=>{T({...b,[t]:""})},te=(t,s)=>{t.preventDefault(),s===i&&(d&&o("/job-listings"),j(null))},A=n.useCallback((t,s)=>{t.preventDefault();const a=window.open(`${window.location.origin}/#${s}`,"_blank","noopener,noreferrer");a&&(a.opener=null)}),R=(t,s)=>{t.preventDefault(),t.altKey===!0&&t.type==="click"||t.type==="auxclick"?A(t,`/job-listings/viewjob?currentJobId=${s}`):(j(s),window.innerWidth<1180?o(`/job-listings/viewjob?currentJobId=${s}`):o(`/job-listings?currentJobId=${s}`))},[se,k]=n.useState(!1),ae=n.useCallback(async t=>{var m;const s=await he("/createChat",{data:{id:t,members:[c._id,g.id],name:(m=r[r.findIndex(l=>l.id===i)])==null?void 0:m.title}});if(!s.ok){const l=await s.json();return N({...p,open:!0,message:l.Error}),!1}const a=await s.json();if(a.chatExists)return N({...p,open:!0,message:"Chat already exists, moving to the chat"}),!0;if(a.Success)return!0}),O=async(t,s)=>{if(t.preventDefault(),c==null)o("/login",{state:{info:"You must be logged in to send a message!"}});else{k(!0);const a=s+c._id+g.id;if(!await ae(a))return setTimeout(()=>{k(!1)},2500);setTimeout(()=>{k(!1),t.altKey&&t.type==="click"||t.type==="auxclick"?A(t,`/chat?currentChatId=${a}`):window.innerWidth<1180?o(`/chat?currentChatId=${a}`):o(`/chat?currentChatId=${a}`)},2500)}};n.useEffect(()=>{let t=null;const s=async()=>{L(!0);const a=await V("/getJobListings");if(!a.ok){const h=await a.json();N({...p,open:!0,message:h.Error});return}const l=(await a.json()).flat().map((h,M)=>{const oe=ue(h.tags);var S=h.posted_at.split("-"),ce=S[2]+"/"+S[1]+"/"+S[0];return{...h,tags:oe,posted_at:ce}});t=setTimeout(()=>{L(!1),E(l)},2500)};return r.length===0&&s(),()=>{t&&clearTimeout(t)}},[]),n.useEffect(()=>(d&&!i&&j(d),()=>{}),[r]),n.useEffect(()=>{if(d&&d!==i){const t=r.findIndex(s=>s.id===d);if(t!==-1){j(r[t].id);return}j(null)}else i&&!d&&j(null);return()=>{}},[d]),n.useEffect(()=>{if(!i)return;let t=null;return(async a=>{_(!0),F(null);const m=await V(`/getUserByIdForJobListing?user_id=${a}`);if(!m.ok){const h=await m.json();if(h.Error){o("/job-listings"),N({...p,open:!0,message:h.Error});return}N({...p,open:!0,message:"An error occurred while trying to fetch the user"});return}const l=await m.json();t=setTimeout(()=>{_(!1),F(l)},2500)})(r[r.findIndex(a=>a.id===i)].user_id),()=>{t&&clearTimeout(t)}},[i]);const[re,ne]=n.useState(930);n.useLayoutEffect(()=>{const t=()=>{const s=window.pageYOffset,a=window.innerHeight,m=Math.round(s*1.05);let l=930+m*.8;switch(!0){case l>a:l=a-20;break;case l<=300:l=300;break;case(l<a&&l>300):l=a-410+m,l>=a&&(l=a-20);break}ne(l)};return window.addEventListener("scroll",t),window.addEventListener("resize",t),()=>{window.removeEventListener("scroll",t),window.removeEventListener("resize",t)}},[]);const I=n.useRef(null),[le,ie]=n.useState(0);n.useLayoutEffect(()=>(I.current&&ie(I.current.getBoundingClientRect().height),()=>{}),[r,g,d]);const $=n.useRef(null);return n.useLayoutEffect(()=>{const t=()=>{$.current&&$.current.getBoundingClientRect().top};return()=>{window.removeEventListener("scroll",t)}},[d]),e.jsxs(n.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-24 w-24 rounded-full border-t-8 border-b-8 border-gray-200"}),e.jsx("div",{className:"absolute top-0 left-0 h-24 w-24 rounded-full border-t-8 border-b-8 border-blue-500 animate-spin"})]})}),children:[p.open&&e.jsx(ve,{alertState:p}),e.jsxs("section",{className:"mx-auto min-h-5",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"mx-5",children:[e.jsx("h1",{className:"mb-10 text-3xl text-center font-bold text-slate-900",children:"Find your next job"}),e.jsx("div",{className:"flex items-center max-md:hidden",children:e.jsxs("div",{className:"flex items-center border border-slate-600 rounded-lg h-[60px] shadow-2xl",children:[C.map((t,s)=>e.jsxs(v.Fragment,{children:[e.jsx("div",{className:"w-[300px] h-full mr-1",children:e.jsxs("label",{className:t.styleProps,children:[t.icon&&t.icon,e.jsx("input",{name:t.name,onChange:a=>D(a,t.name),className:"outline-none w-3/4",type:"text",placeholder:t.placeholder,value:b[t.name]}),b[t.name]&&e.jsx(w,{onClick:()=>{P(t.name)},className:"ml-1 bg-white hover:bg-[#a0a0a06e]",children:e.jsx("span",{className:"text-black",children:"X"})})]})}),s<C.length-1&&e.jsx(Z,{className:"h-6 w-px mr-2 ml-0.5 bg-slate-400"})]},s)),e.jsx(w,{className:"mr-2",children:"Search"})]})}),e.jsxs("div",{className:"hidden max-md:block",children:[e.jsx("div",{className:"flex items-center justify-center gap-2 h-max mx-auto",children:e.jsx("div",{className:"flex flex-col items-center gap-2",children:C.map((t,s)=>e.jsx(v.Fragment,{children:e.jsx("div",{className:"h-full w-[400px] max-extraSm:w-[300px]",children:e.jsx("label",{className:"flex items-center border border-slate-600 text-slate-600 w-full h-[60px] px-2 rounded-lg focus-within:outline-none focus-within:border focus-within:border-violet-700 focus-within:rounded-br-sm focus-within:rounded-tr-sm focus-within:rounded-bl-lg focus-within:rounded-tl-lg focus-within:border-b-4 hover:cursor-text",children:e.jsxs("div",{className:"flex items-center text-slate-600 w-full",children:[t.icon&&t.icon,e.jsx("input",{name:t.name,onChange:a=>D(a,t.name),className:"outline-none w-full h-full",type:"text",placeholder:t.placeholder,value:b[t.name]}),b[t.name]&&e.jsx(w,{onClick:()=>{P(t.name)},className:"bg-white hover:bg-[#a0a0a06e]",children:e.jsx("span",{className:"text-black",children:"X"})})]})})})},s))})}),e.jsx("div",{className:"flex items-center justify-center mt-5",children:e.jsx(w,{className:"w-full",children:"Search"})})]}),e.jsx("div",{className:"my-5",children:c&&c.account_type[0]==="option_requester"&&e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("h1",{onClick:()=>{o("/job-listings/new")},className:"w-fit text-center hover:underline hover:cursor-pointer text-[#e8562ddd] font-bold",children:"Post a help enquiry"})})})]})}),e.jsx("hr",{className:"w-full opacity-30 border-t border-slate-400"}),e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsxs("div",{className:"flex justify-center my-5 w-[900px]",children:[e.jsxs("div",{className:"flex items-center flex-col mt-5 w-full",children:[y?e.jsx("div",{className:"mx-5 h-auto mb-2 bg-white border-2 border-black rounded-lg lg:w-[700px] md:w-[700px] sm:w-[400px] extraSm:w-[400px] max-extraSm:w-[300px]",children:e.jsx("div",{className:"flex items-center justify-between m-5",children:e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"space-y-2 p-5",children:[e.jsx(x,{className:"h-4 w-[250px] md:w-[350px] lg:w-[350px]"}),e.jsx(x,{className:"h-4 w-[200px]"}),e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx(x,{className:"h-2 w-[50px]"}),e.jsx(x,{className:"h-2 w-[50px]"}),e.jsx(x,{className:"h-2 w-[50px]"}),e.jsx(x,{className:"h-2 w-[50px]"})]}),e.jsx(x,{className:"h-4 w-[100px]"})]})})})}):r.length===0?e.jsx("div",{className:"flex items-center justify-center w-full h-full gap-2",children:e.jsx("div",{className:"flex items-center justify-center gap-2 w-full",children:e.jsx("div",{className:"flex items-center justify-center w-full h-full gap-2",children:e.jsx("div",{className:"flex items-center justify-center w-full h-full gap-2",children:e.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"No job listings found"})})})})}):null,r.length!==0&&r.map((t,s)=>{const a=s+1,m=t.id;return e.jsx("div",{ref:$,onClick:l=>R(l,m),onAuxClick:l=>R(l,m),className:`mx-5 group h-auto mb-2 bg-white border-2 rounded-lg hover:cursor-pointer ${i?"lg:w-[500px] md:w-[700px] sm:w-[400px] extraSm:w-[400px] max-extraSm:w-[300px]":"lg:w-[700px] md:w-[700px] sm:w-[400px] extraSm:w-[400px] max-extraSm:w-[300px]"} ${i&&i===m?"border-[#e8562d]":"border-black"}`,children:e.jsx("div",{className:"flex items-center justify-between m-5",children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"w-full inline-block break-words whitespace-normal",children:[e.jsx("h1",{className:"text-xl font-bold text-slate-900 group-hover:underline",children:t.title}),e.jsx("p",{className:"text-slate-600",children:t.location}),e.jsx("p",{className:"text-slate-600 text-sm line-clamp-2",children:t.description})]}),e.jsx("div",{role:"tags",className:"grid grid-flow-row-dense grid-cols-4 items-center mt-2 gap-1 text-center text-black text-opacity-70 group-hover:text-opacity-90",children:Object.entries(t.tags).filter(([l,h])=>h!==""&&l.startsWith("Tag_")).map(([l,h],M)=>e.jsx("div",{className:"bg-slate-100 px-2 py-1 h-full rounded-md text-ellipsis overflow-hidden flex items-center justify-center",children:e.jsx("p",{className:"text-xs",children:h})},M))}),e.jsx("div",{className:"flex items-center mt-3",children:e.jsxs("p",{className:"text-slate-600 text-sm",children:["Posted on ",t.posted_at]})})]})})},a)}),r.length!==0&&e.jsx("div",{className:"flex items-center justify-center my-2 w-1/2",children:e.jsx(w,{className:"w-full",children:"Load More"})})]}),i&&e.jsx("div",{className:"w-[600px] h-dvh md:min-h-svh max-md:min-h-svh sticky top-2 z-50 lg:block md:hidden sm:hidden extraSm:hidden max-extraSm:hidden mr-5",children:e.jsx("div",{className:"bg-white border-2 border-black rounded-lg box-border w-[600px]",style:{height:`${re+2}px`},children:ee?e.jsxs(v.Fragment,{children:[e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"space-y-2 p-5",children:[e.jsx(x,{className:"h-4 w-[350px]"}),e.jsx(x,{className:"h-4 w-[200px]"})]})}),e.jsx("hr",{className:"w-11/12 mx-5 opacity-30 border-t border-slate-400"}),e.jsxs("div",{className:"space-y-2 p-5",children:[e.jsx(x,{className:"h-4 w-[300px]"}),e.jsx(x,{className:"h-4 w-[200px]"}),e.jsx(x,{className:"h-4 w-full"}),e.jsx(x,{className:"h-4 w-full"})]})]}):e.jsxs(v.Fragment,{children:[e.jsx("div",{className:"flex items-center",children:e.jsx("div",{ref:I,className:"shadow-md w-full rounded-sm",children:e.jsxs("div",{className:"p-5",children:[e.jsx(w,{onClick:t=>{te(t,i)},className:"bg-white hover:bg-[#a0a0a06e] absolute top-2 right-2",children:e.jsx("span",{className:"text-black",children:"X"})}),e.jsxs("div",{className:"w-11/12 inline-block whitespace-normal break-words",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:(z=r[r.findIndex(t=>t.id===i)])==null?void 0:z.title}),e.jsxs("h1",{className:"w-fit text-md text-slate-900 underline hover:cursor-pointer",children:["by ",g?g.name:""]}),e.jsx("p",{className:"text-slate-600 text-opacity-75",children:(B=r[r.findIndex(t=>t.id===i)])==null?void 0:B.location})]}),e.jsx("div",{role:"tags",className:"grid grid-flow-row-dense grid-cols-4 items-center mt-2 gap-1 text-center text-black text-opacity-70 group-hover:text-opacity-90",children:Object.entries((H=r[r.findIndex(t=>t.id===i)])==null?void 0:H.tags).filter(([t,s])=>s!==""&&t.startsWith("Tag_")).map(([t,s],a)=>e.jsx("div",{className:"bg-slate-100 px-2 py-1 h-full rounded-md text-ellipsis overflow-hidden flex items-center justify-center",children:e.jsx("p",{className:"text-xs",children:s})},a))}),e.jsx(w,{disabled:se,onClick:t=>O(t,i),onAuxClick:t=>O(t,i),className:"mt-5 bg-[#dd673cfd] bg-opacity-90 hover:bg-[#e8432dea] hover:bg-opacity-100",children:"Message"})]})})}),e.jsxs(je,{className:"w-full",style:{height:`calc(100% - ${le}px)`},children:[e.jsxs("div",{className:"w-[55%] inline-block whitespace-normal break-words",children:[e.jsxs("div",{className:"p-5",children:[e.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"Job Details"}),e.jsx("p",{className:"text-slate-600",children:(U=r[r.findIndex(t=>t.id===i)])==null?void 0:U.location})]}),e.jsxs("div",{className:"p-5",children:[e.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"Job Full Description"}),e.jsx("p",{className:"text-slate-600 line-clamp-2",children:(W=r[r.findIndex(t=>t.id===i)])==null?void 0:W.description})]}),((q=r[r.findIndex(t=>t.id===i)])==null?void 0:q.additional_information)&&e.jsxs(v.Fragment,{children:[e.jsx("hr",{className:"w-full opacity-30 border-t border-slate-400"}),e.jsxs("div",{className:"p-5",children:[e.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"Job Additional Details"}),e.jsx("p",{className:"text-slate-600",children:(G=r[r.findIndex(t=>t.id===i)])==null?void 0:G.additional_information})]})]})]}),e.jsx(ge,{orientation:"vertical"})]})]})})})]})})]})]})};export{Ae as default};
